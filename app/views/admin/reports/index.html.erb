<% content_for :meta_title, "Reports Dashboard - Admin | Red Tape LA" %>
<% content_for :meta_description, "Admin dashboard for managing Red Tape LA reports. View, review, and track submitted reports." %>

<div class="container" style="max-width: 1000px;">
  <h1>Red Tape Reports Dashboard</h1>

  <div class="stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 32px;">
    <div class="stat-card">
      <div class="stat-number"><%= @total_approved %></div>
      <div class="stat-label">Approved Reports</div>
    </div>
    <div class="stat-card" style="<%= 'background-color: #fef3c7; border-color: #f59e0b;' if @pending_review_count > 0 %>">
      <div class="stat-number"><%= @pending_review_count %></div>
      <div class="stat-label">Pending Review</div>
    </div>
    <div class="stat-card">
      <div class="stat-number"><%= @unverified_count %></div>
      <div class="stat-label">Unverified</div>
    </div>
  </div>

  <div class="filter-tabs" style="display: flex; gap: 8px; margin-bottom: 16px; border-bottom: 2px solid #e5e7eb;">
    <%= link_to "All", admin_reports_path(filter: "all"),
        class: "filter-tab #{@filter == 'all' ? 'active' : ''}",
        style: "padding: 8px 16px; text-decoration: none; color: #374151; border-bottom: 2px solid #{@filter == 'all' ? '#2563eb' : 'transparent'}; margin-bottom: -2px;" %>
    <%= link_to "Pending Review", admin_reports_path(filter: "pending_review"),
        class: "filter-tab #{@filter == 'pending_review' ? 'active' : ''}",
        style: "padding: 8px 16px; text-decoration: none; color: #374151; border-bottom: 2px solid #{@filter == 'pending_review' ? '#2563eb' : 'transparent'}; margin-bottom: -2px;" %>
    <%= link_to "Approved", admin_reports_path(filter: "approved"),
        class: "filter-tab #{@filter == 'approved' ? 'active' : ''}",
        style: "padding: 8px 16px; text-decoration: none; color: #374151; border-bottom: 2px solid #{@filter == 'approved' ? '#2563eb' : 'transparent'}; margin-bottom: -2px;" %>
    <%= link_to "Unverified", admin_reports_path(filter: "unverified"),
        class: "filter-tab #{@filter == 'unverified' ? 'active' : ''}",
        style: "padding: 8px 16px; text-decoration: none; color: #374151; border-bottom: 2px solid #{@filter == 'unverified' ? '#2563eb' : 'transparent'}; margin-bottom: -2px;" %>
  </div>

  <div class="card">
    <% if @reports.any? %>
      <table class="reports-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Project Type</th>
            <th>Location</th>
            <th>Status</th>
            <th>Submitted</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% @reports.each do |report| %>
            <tr>
              <td data-label="ID"><strong>#<%= report.id %></strong></td>
              <td data-label="Project Type"><%= report.project_type %></td>
              <td data-label="Location"><%= truncate(report.location, length: 40) %></td>
              <td data-label="Status">
                <% if report.approved? %>
                  <span class="status-badge status-badge--approved">Approved</span>
                <% elsif report.verified? %>
                  <span class="status-badge status-badge--pending">Pending Review</span>
                <% else %>
                  <span class="status-badge status-badge--unverified">Unverified</span>
                <% end %>
              </td>
              <td data-label="Submitted" class="text-small">
                <%= time_ago_in_words(report.created_at) %> ago
              </td>
              <td data-label="">
                <%= link_to "View", admin_report_path(report), class: "btn-link" %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% else %>
      <div style="text-align: center; padding: 40px 0;">
        <p class="text-small">No reports submitted yet.</p>
      </div>
    <% end %>
  </div>
</div>